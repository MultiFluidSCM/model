% Test N-diagonal solver
clear


% 5x5 example

BB = [6,1,1,0,0; ...
      1,6,1,1,0;...
      1,1,6,1,1;...
      0,1,1,6,1;...
      0,0,1,1,6];
  
x = [1,2,3,4,5]';

r = (BB*x)'

cc = [1,1,6,1,1; ...
      1,1,6,1,1; ...
      1,1,6,1,1; ...
      1,1,6,1,1; ...
      1,1,6,1,1]';

xx = Ndiagsolveb(cc,r)
xx = Ndiagsolvex(cc,r)

r = Ndiagmult(cc,xx)


% 9 x 9 example

BB = [5, 2, 1,-1, 1, 0, 0, 0, 0; ...
      2, 5, 2, 1,-1, 1, 0, 0, 0; ...
      1, 2, 5, 2, 1,-1, 1, 0, 0; ...
     -1, 1, 2, 5, 2, 1,-1, 1, 0; ...
      1,-1, 1, 2, 5, 2, 1,-1, 1; ...
      0, 1,-1, 1, 2, 5, 2, 1,-1; ...
      0, 0, 1,-1, 1, 2, 5, 2, 1; ...
      0, 0, 0, 1,-1, 1, 2, 5, 2; ...
      0, 0, 0, 0, 1,-1, 1, 2, 5];
  
x = [3,1,3,1,3,1,3,1,3]';

r = (BB*x)'

cc = [1,-1,1,2,5,2,1,-1,1; ...
      1,-1,1,2,5,2,1,-1,1; ...
      1,-1,1,2,5,2,1,-1,1; ...
      1,-1,1,2,5,2,1,-1,1; ...
      1,-1,1,2,5,2,1,-1,1; ...
      1,-1,1,2,5,2,1,-1,1; ...
      1,-1,1,2,5,2,1,-1,1; ...
      1,-1,1,2,5,2,1,-1,1; ...
      1,-1,1,2,5,2,1,-1,1]';
  
xx = Ndiagsolveb(cc,r)
xx = Ndiagsolvex(cc,r)
  
r = Ndiagmult(cc,xx)
  
